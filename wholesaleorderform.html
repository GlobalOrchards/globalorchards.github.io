<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Price List</title>
    <style>
        :root {
            --bg-color: #f8f9fc;
            --card-bg-color: #ffffff;
            --text-color-primary: #1a202c;
            --text-color-secondary: #4a5568;
            --header-bg-color: #059669; /* Changed to green */
            --header-text-color: #ffffff;
            --accent-color: #059669; /* Changed to green */
            --border-color: #e2e8f0;
            --input-focus-border: var(--accent-color);
            --input-focus-shadow: rgba(5, 150, 105, 0.25); /* Updated for green */
            --footer-bg-color: #f3f4f6;
            --footer-border-color: #e5e7eb;
            --footer-text-color: #374151;
            --swipe-msg-bg: #d1fae5; /* Light green background */
            --swipe-msg-text: #065f46; /* Dark green text */
            --button-bg-color: var(--accent-color);
            --button-hover-bg-color: #047857; /* Darker green */
            --button-text-color: #ffffff;
            --form-section-bg: #f9fafb;
            /* Tab colors updated to green */
            --tab-active-border: var(--accent-color);
            --tab-text-color: var(--text-color-secondary);
            --tab-active-text-color: var(--accent-color);
        }

        .strike-red {
            color: red;
            font-weight: bold;
            text-decoration: line-through;
            text-align: right;
        }
        
        body {
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            line-height: 1.45;
            background-color: var(--bg-color);
            color: var(--text-color-primary);
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .swipe-indicator {
            width: 95%;
            max-width: 920px;
            text-align: center;
            padding: 8px 12px;
            background-color: var(--swipe-msg-bg);
            color: var(--swipe-msg-text);
            font-weight: 500;
            font-size: 0.9em;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .swipe-indicator svg {
            width: 20px; height: 20px;
            margin-right: 8px;
            flex-shrink: 0;
        }

        .container {
            width: 95%; /* Increased from 90% */
            max-width: 920px;
            background-color: var(--card-bg-color);
            padding: 15px 15px 20px 15px; /* Reduced from 20px 25px 25px 25px */
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(60, 60, 90, 0.08), 0 3px 8px rgba(60, 60, 90, 0.06);
            margin-bottom: 10px; /* Reduced from 15px */
        }

        .main-title-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }

        .store-logo {
            width: 250px;
            height: auto;
            margin-right: 20px;
        }

        h1 {
            color: var(--text-color-primary);
            text-align: left;
            font-size: 2.0em;
            font-weight: 700;
            letter-spacing: -0.5px;
            margin-top: 0; 
            margin-bottom: 0; 
        }

        .pickup-address-details { 
            margin-bottom: 25px; 
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--form-section-bg);
            font-size: 0.95em;
            line-height: 1.5;
        }

        .pickup-address-details h3 {
            margin-top: 0;
            margin-bottom: 8px;
            font-size: 1.15em;
            color: var(--text-color-primary);
        }
        .pickup-address-details strong {
            font-weight: 600;
        }

        .effective-date {
            text-align: center;
            margin-top: 5px; 
            margin-bottom: 15px; 
            color: var(--text-color-secondary);
            font-size: 1em; 
            font-weight: 500;
        }

        /* Tab Styles */
        .tabs-container {
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            background-color: var(--form-section-bg);
            padding: 10px;
        }
        .tab-navigation {
            display: flex;
            flex-wrap: wrap;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 10px;
        }
        .tab-button {
            padding: 10px 15px;
            font-size: 1em;
            font-weight: 600;
            border: none;
            background-color: transparent;
            cursor: pointer;
            color: var(--tab-text-color); 
            border-bottom: 3px solid transparent;
            margin-right: 5px;
            margin-bottom: -2px;
            transition: color 0.2s, border-color 0.2s;
        }
        .tab-button.active {
            color: var(--tab-active-text-color); 
            border-bottom-color: var(--tab-active-border); 
        }
        .tab-button:hover {
            color: var(--tab-active-text-color);
        }
        .tab-content .tab-pane {
            display: none;
        }
        .tab-content .tab-pane.active {
            display: block;
        }

        .table-wrapper { 
            overflow-x: auto;
            width: 100%;
            border: 1px solid var(--border-color); 
            border-radius: 10px; 
            -webkit-overflow-scrolling: touch;
            margin-top: 10px; 
            position: relative;
            overflow: visible;
        }
        .tab-pane > .table-wrapper {
             margin-bottom: 0; 
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border-bottom: 1px solid var(--border-color);
            padding: 6px 14px; 
            vertical-align: middle;
            white-space: nowrap;
            font-size: 1.1em; 
            font-weight: 700; 
            line-height: 1.2; 
        }
        
        th {
            background-color: var(--header-bg-color);
            color: var(--header-text-color);
            font-weight: 700; 
            text-transform: uppercase;
            letter-spacing: 0.75px;
            font-size: 0.85em; 
            text-align: center;
        }

        td.name { text-align: left; }
        td.description {
            text-align: left;
            max-width: 120px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* Expanded description styles */
        tr.description-expanded td.description {
            position: absolute;
            left: 0;
            right: 0;
            max-width: none;
            white-space: normal;
            background: white;
            color: var(--text-color-primary);
            padding: 12px;
            border: 2px solid var(--accent-color);
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 100;
            font-weight: 600;
            text-overflow: initial;
            overflow: visible;
            text-align: left;
            width: calc(100% - 2px);
            box-sizing: border-box;
        }

        /* Ensure the expanded row has proper positioning context and contains the expansion */
        tr.description-expanded {
            position: relative;
        }

        /* Adjust for mobile */
        @media (max-width: 768px) {
            .table-wrapper {
                margin: 0 -5px; /* Negative margin to extend to edges */
                border-radius: 0; /* Remove border radius on mobile for full width */
                border-left: none;
                border-right: none;
            }
            td.description {
                max-width: 80px;
            }
                body {
            padding: 5px; /* Reduced from 10px */
            }
            .container {
                width: 98%; /* Use almost full width on mobile */
                padding: 10px; /* Even less padding on mobile */
                border-radius: 12px;
            }
            .swipe-indicator {
                width: 98%;
                padding: 6px 10px; /* Slightly reduce padding */
                font-size: 0.8em; /* Slightly smaller text */
                margin-bottom: 10px; /* Reduced from 15px */
            }
            .tabs-container {
                padding: 5px; /* Reduced from 10px */
            }
            
            .pickup-address-details {
                padding: 8px; /* Reduced from 10px */
                margin-bottom: 15px; /* Reduced from 25px */
            }
            
            #visibleOrderSummaryContainer,
            .customer-info-section {
                padding: 12px; /* Reduced from 20px */
                margin-top: 10px; /* Reduced from 15px */
            }
            
            .tab-content {
                padding: 5px; /* Reduced from default */
            }
        }
        td.num-box { text-align: right; }
        td.price { 
            text-align: right;
            color: #059669;
            font-weight: 800; /* Make it even bolder */
            }
        td.qty-cell { text-align: center; }

        tbody tr:nth-child(even) td {
            background-color: #f9fafb; 
        }
        tbody tr:hover td {
            background-color: #f0f2f5;
            transition: background-color 0.15s ease-in-out;
        }

        /* Quantity controls with plus/minus buttons */
        .qty-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.375rem;
        }

        .qty-btn {
            width: 28px;
            height: 28px;
            border: 1px solid var(--accent-color);
            background: var(--accent-color);
            color: #ffffff;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s ease;
            font-size: 1.2rem;
            font-weight: 600;
            user-select: none;
        }

        .qty-btn:hover {
            background: var(--button-hover-bg-color);
            transform: scale(1.1);
        }

        .qty-btn:active {
            transform: scale(0.95);
        }

        .qty-input {
            width: 50px;
            height: 28px;
            text-align: center;
            border: 1px solid #cbd5e1;
            border-radius: 4px;
            font-size: 0.9em;
            font-weight: 600;
            color: var(--text-color-primary);
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        .qty-input:focus {
            border-color: var(--input-focus-border);
            outline: 0;
            box-shadow: 0 0 0 0.2rem var(--input-focus-shadow);
        }

        .qty-input::-webkit-outer-spin-button,
        .qty-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .qty-input[type=number] {
            -moz-appearance: textfield;
        }
        
        #visibleOrderSummaryContainer {
            background-color: var(--form-section-bg); 
            padding: 20px; border-radius: 10px; margin-top: 25px; margin-bottom: 15px; 
            border: 1px solid var(--border-color);
        }
        #visibleOrderSummaryContainer h2 {
            font-size: 1.3em; color: var(--text-color-primary); margin-top: 0; margin-bottom: 15px;
            text-align: center; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;
        }
        
        #lineItemsDisplay ul { list-style-type: none; padding-left: 0; margin: 0; }
        #lineItemsDisplay li { padding: 5px 0; border-bottom: 1px dotted var(--border-color); font-size: 0.95em; }
        #lineItemsDisplay li:last-child { border-bottom: none; }
        #lineItemsDisplay p { font-style: italic; color: var(--text-color-secondary); text-align: center; }

        .customer-info-section {
            background-color: var(--form-section-bg); padding: 20px; border-radius: 10px;
            margin-top: 15px; border: 1px solid var(--border-color);
        }
        .customer-info-section h2 {
            font-size: 1.3em; color: var(--text-color-primary); margin-top: 0; margin-bottom: 15px;
            text-align: center; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; 
        }
        .form-group { margin-bottom: 12px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 5px; color: var(--text-color-secondary); font-size: 0.9em; }
        .form-group input[type="text"], .form-group input[type="email"], .form-group input[type="tel"], .form-group input[type="date"], .form-group select {            
            width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; box-sizing: border-box; font-size: 0.95em; 
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out; background-color: #fff; 
        }
        .form-group input[type="text"]:focus, .form-group input[type="email"]:focus, .form-group input[type="tel"]:focus, .form-group input[type="date"]:focus, .form-group select:focus {            
            border-color: var(--input-focus-border); outline: 0; box-shadow: 0 0 0 0.2rem var(--input-focus-shadow);
        }
        
        /* Larger date input */
        .form-group input[type="date"] {
            font-size: 1.1rem;
            padding: 12px;
        }

        /* Time slot buttons */
        .time-slot-container {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .time-slot-btn {
            flex: 1;
            min-width: 150px;
            padding: 12px 20px;
            border: 2px solid var(--border-color);
            background: var(--white);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-color-primary);
            text-align: center;
            transition: all 0.2s ease;
        }

        .time-slot-btn:hover {
            border-color: var(--accent-color);
            background: rgba(5, 150, 105, 0.05);
        }

        .time-slot-btn.selected {
            background: var(--accent-color);
            color: var(--white);
            border-color: var(--accent-color);
        }

        .time-slot-btn input[type="radio"] {
            display: none;
        }
        
        .form-summary { margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--border-color); display: flex; justify-content: flex-end; align-items: center; gap: 15px; }
        .submit-button { background-color: var(--button-bg-color); color: var(--button-text-color); border: none; padding: 10px 20px; font-size: 1em; font-weight: 600; border-radius: 8px; cursor: pointer; transition: background-color 0.15s ease-in-out, transform 0.1s ease; box-shadow: 0 3px 8px rgba(5, 150, 105, 0.15); }
        .submit-button:hover { background-color: var(--button-hover-bg-color); transform: translateY(-1px); }
        .submit-button:active { transform: translateY(0px); }
        .submit-button:disabled { background-color: #9ca3af; cursor: not-allowed; transform: none; }

        .footer-contact { text-align: center; font-weight: 500; color: var(--footer-text-color); margin-top: 20px; font-size: 1.05em; padding: 15px; background-color: var(--footer-bg-color); border-radius: 12px; border: 1px solid var(--footer-border-color); }
        .success-message, .error-message { padding: 15px; border-radius: 8px; margin-top: 15px; text-align: center; font-weight: 500; display: none; }
        .success-message { background-color: #d4edda; color: #155724; }
        .error-message { background-color: #f8d7da; color: #721c24; }
        
        /* Order Summary Table Styling */
        #orderSummaryTable {
            width: 100%;
            border-collapse: collapse;
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        #orderSummaryTable th,
        #orderSummaryTable td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        #orderSummaryTable th:last-child,
        #orderSummaryTable td:last-child {
            text-align: right;
        }
        #orderSummaryTable tfoot td {
            border-top: 2px solid var(--border-color);
            font-weight: 700;
        }
        #orderSummaryTable tfoot td:last-child {
            text-align: right;
        }

        /* Order Summary Table Wrapper - no height limit */
        #lineItemsDisplay .table-wrapper {
            overflow-x: auto;  /* Keep horizontal scroll if needed */
            overflow-y: visible;  /* No vertical scroll */
        }

        #orderSummaryTable tfoot td:last-child {
            text-align: right;
        }

    </style>
</head>
<body>
    <div class="swipe-indicator">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
            <path d="m12.299 5.701-1.414 1.414 3.585 3.585H4V12.7h10.47l-3.586 3.586 1.414 1.414L19.414 12l-7.115-6.299Z"/>
        </svg>
        Table may require horizontal scrolling &nbsp;<strong>&gt;&gt;&gt;</strong>&nbsp; Swipe or use scrollbar
    </div>

    <div class="container">
        <div class="main-title-container">
            <img src="images/TopsLogoCrop.png" alt="Tops Supermarket Logo" class="store-logo"> <h1>Price List</h1>
        </div>
        <p class="effective-date">Effective Date: <strong>From May 25, 2025</strong></p>
        <div class="pickup-address-details"> <h3>Pickup address:</h3>
            <strong>Tops Supermarket</strong>
            <br>1623 Centre St NW
            <br>Calgary, AB  T2E 2S3
            <br>Phone: 403-276-8889
            <br>Hours: 9:00am - 4:00pm
            <br>    ---
        </div>

        <form id="orderForm" action="https://formspree.io/f/mnndygrk" method="POST">
            
            <div class="tabs-container">
            <div class="tab-navigation">
                    <button type="button" class="tab-button active" data-tab="meat">Meat</button>
                    <button type="button" class="tab-button" data-tab="vegetable">Vegetable</button>
                    <button type="button" class="tab-button" data-tab="fruit">Fruit</button>
                    <button type="button" class="tab-button" data-tab="seafood">Seafood</button>
                    <button type="button" class="tab-button" data-tab="grocery">Grocery</button>
                </div>
            <div class="tab-content">
                    <div id="meat" class="tab-pane active">
                        <div class="table-wrapper"><table><thead><tr>
                            <th class="description">Description</th>
                            <th class="num-box"># Box</th><th class="name">Retail</th><th class="price">Price</th><th class="qty">Qty</th>
                        </tr></thead><tbody>
                        <tr>
                            <td class="description">King's Chicken -7003</td>
                            <td class="num-box">EA</td>
                            <td class="retail strike-red">$28.76</td>
                            <td class="price">$20.54</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 7003_qty" placeholder="0" aria-label="Quantity for King's Chicken -7003"></td>
                        </tr>
                        <tr>
                            <td class="description">Chicken</td>
                            <td class="num-box">EA</td>
                            <td class="retail strike-red">$1.40</td>
                            <td class="price">$1.00</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 802_qty" placeholder="0" aria-label="Quantity for Chicken"></td>
                        </tr>
                        <tr>
                            <td class="description">Pork Front Feet</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$4.53</td>
                            <td class="price">$3.24</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 5027_qty" placeholder="0" aria-label="Quantity for Pork Front Feet"></td>
                        </tr>
                        <tr>
                            <td class="description">Pork Belly Boneless</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$7.18</td>
                            <td class="price">$5.13</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 5010_qty" placeholder="0" aria-label="Quantity for Pork Belly Boneless"></td>
                        </tr>
                        <tr>
                            <td class="description">Utility Silkie Chicken</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$8.77</td>
                            <td class="price">$6.26</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 337_qty" placeholder="0" aria-label="Quantity for Utility Silkie Chicken"></td>
                        </tr>
                        <tr>
                            <td class="description">AAA Beef Fingermeat</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$11.85</td>
                            <td class="price">$8.47</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 60111_qty" placeholder="0" aria-label="Quantity for AAA Beef Fingermeat"></td>
                        </tr>
                        <tr>
                            <td class="description">AAA Beef Short Rib</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$12.02</td>
                            <td class="price">$8.59</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 6008_qty" placeholder="0" aria-label="Quantity for AAA Beef Short Rib"></td>
                        </tr>
                        <tr>
                            <td class="description">WW Chinese Style Pork Sausage</td>
                            <td class="num-box">375g</td>
                            <td class="retail strike-red">$7.52</td>
                            <td class="price">$5.37</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 66736676889_qty" placeholder="0" aria-label="Quantity for WW Chinese Style Pork Sausage"></td>
                        </tr>
                        <tr>
                            <td class="description">Beef Heel Muscle(Digital)</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$12.05</td>
                            <td class="price">$8.61</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 6004_qty" placeholder="0" aria-label="Quantity for Beef Heel Muscle(Digital)"></td>
                        </tr>
                        <tr>
                            <td class="description">Chicken Feet-Jumbo</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$4.66</td>
                            <td class="price">$3.33</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 70071_qty" placeholder="0" aria-label="Quantity for Chicken Feet-Jumbo"></td>
                        </tr>
                        <tr>
                            <td class="description">Pork</td>
                            <td class="num-box">EA</td>
                            <td class="retail strike-red">$1.40</td>
                            <td class="price">$1.00</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 801_qty" placeholder="0" aria-label="Quantity for Pork"></td>
                        </tr>
                        <tr>
                            <td class="description">Watson Cooked Young Duck</td>
                            <td class="num-box">500g</td>
                            <td class="retail strike-red">$12.59</td>
                            <td class="price">$8.99</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 800794301297_qty" placeholder="0" aria-label="Quantity for Watson Cooked Young Duck"></td>
                        </tr>
                        <tr>
                            <td class="description">Pork Shoulder Butt</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$6.20</td>
                            <td class="price">$4.43</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 5001_qty" placeholder="0" aria-label="Quantity for Pork Shoulder Butt"></td>
                        </tr>
                        </tbody><tfoot><tr><td colspan="5" style="border-bottom: none; padding: 3px;"></td></tr></tfoot></table></div></div>
                    <div id="vegetable" class="tab-pane">
                        <div class="table-wrapper"><table><thead><tr>
                            <th class="description">Description</th>
                            <th class="num-box"># Box</th><th class="name">Retail</th><th class="price">Price</th><th class="qty">Qty</th>
                        </tr></thead><tbody>
                        <tr>
                            <td class="description">Yu Choy £¨Red£© - 421</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$3.01</td>
                            <td class="price">$2.15</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 421_qty" placeholder="0" aria-label="Quantity for Yu Choy £¨Red£© - 421"></td>
                        </tr>
                        <tr>
                            <td class="description">Lo Bok - 450</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$1.28</td>
                            <td class="price">$0.91</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 450_qty" placeholder="0" aria-label="Quantity for Lo Bok - 450"></td>
                        </tr>
                        <tr>
                            <td class="description">Short Nappa - 046</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$2.01</td>
                            <td class="price">$1.44</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 46_qty" placeholder="0" aria-label="Quantity for Short Nappa - 046"></td>
                        </tr>
                        <tr>
                            <td class="description">Green Chives -105</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$4.49</td>
                            <td class="price">$3.21</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 105_qty" placeholder="0" aria-label="Quantity for Green Chives -105"></td>
                        </tr>
                        <tr>
                            <td class="description">Yu Choy Mui - 460</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$4.42</td>
                            <td class="price">$3.16</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 460_qty" placeholder="0" aria-label="Quantity for Yu Choy Mui - 460"></td>
                        </tr>
                        <tr>
                            <td class="description">Shang Hai Bok Choy - 033</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$2.45</td>
                            <td class="price">$1.75</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 33_qty" placeholder="0" aria-label="Quantity for Shang Hai Bok Choy - 033"></td>
                        </tr>
                        <tr>
                            <td class="description">Chinese Eggplant  - 102</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$2.97</td>
                            <td class="price">$2.12</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 102_qty" placeholder="0" aria-label="Quantity for Chinese Eggplant  - 102"></td>
                        </tr>
                        <tr>
                            <td class="description">Shanghai Choy Mui - 0991</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$3.78</td>
                            <td class="price">$2.70</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 991_qty" placeholder="0" aria-label="Quantity for Shanghai Choy Mui - 0991"></td>
                        </tr>
                        <tr>
                            <td class="description">Baby Bok Choy - 007</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$2.56</td>
                            <td class="price">$1.83</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 7_qty" placeholder="0" aria-label="Quantity for Baby Bok Choy - 007"></td>
                        </tr>
                        <tr>
                            <td class="description">Gailan (Red) 0981</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$3.65</td>
                            <td class="price">$2.61</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 981_qty" placeholder="0" aria-label="Quantity for Gailan (Red) 0981"></td>
                        </tr>
                        <tr>
                            <td class="description">Broccoli - 0361</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$2.41</td>
                            <td class="price">$1.72</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 361_qty" placeholder="0" aria-label="Quantity for Broccoli - 0361"></td>
                        </tr>
                        <tr>
                            <td class="description">Cabbage - 0381</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$1.58</td>
                            <td class="price">$1.13</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 381_qty" placeholder="0" aria-label="Quantity for Cabbage - 0381"></td>
                        </tr>
                        <tr>
                            <td class="description">A Choy -119</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$3.56</td>
                            <td class="price">$2.55</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 119_qty" placeholder="0" aria-label="Quantity for A Choy -119"></td>
                        </tr>
                        <tr>
                            <td class="description">Ginger - 004</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$3.55</td>
                            <td class="price">$2.54</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 4_qty" placeholder="0" aria-label="Quantity for Ginger - 004"></td>
                        </tr>
                        </tbody><tfoot><tr><td colspan="5" style="border-bottom: none; padding: 3px;"></td></tr></tfoot></table></div></div>
                    <div id="fruit" class="tab-pane">
                        <div class="table-wrapper"><table><thead><tr>
                            <th class="description">Description</th>
                            <th class="num-box"># Box</th><th class="name">Retail</th><th class="price">Price</th><th class="qty">Qty</th>
                        </tr></thead><tbody>
                        <tr>
                            <td class="description">Golden Logan box - 0801</td>
                            <td class="num-box">CS</td>
                            <td class="retail strike-red">$20.25</td>
                            <td class="price">$14.46</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 801_qty" placeholder="0" aria-label="Quantity for Golden Logan box - 0801"></td>
                        </tr>
                        <tr>
                            <td class="description">Peruvian Mango</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$7.78</td>
                            <td class="price">$5.56</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 4173_qty" placeholder="0" aria-label="Quantity for Peruvian Mango"></td>
                        </tr>
                        <tr>
                            <td class="description">Blue Jay Oranges - 4013</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$2.36</td>
                            <td class="price">$1.69</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 4013_qty" placeholder="0" aria-label="Quantity for Blue Jay Oranges - 4013"></td>
                        </tr>
                        <tr>
                            <td class="description">Sweet Tangerine - 075</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$2.92</td>
                            <td class="price">$2.09</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 75_qty" placeholder="0" aria-label="Quantity for Sweet Tangerine - 075"></td>
                        </tr>
                        </tbody><tfoot><tr><td colspan="5" style="border-bottom: none; padding: 3px;"></td></tr></tfoot></table></div></div>
                    <div id="seafood" class="tab-pane">
                        <div class="table-wrapper"><table><thead><tr>
                            <th class="description">Description</th>
                            <th class="num-box"># Box</th><th class="name">Retail</th><th class="price">Price</th><th class="qty">Qty</th>
                        </tr></thead><tbody>
                        <tr>
                            <td class="description">Searay White Shrimp 31/40</td>
                            <td class="num-box">1LB</td>
                            <td class="retail strike-red">$9.79</td>
                            <td class="price">$6.99</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 827510001866_qty" placeholder="0" aria-label="Quantity for Searay White Shrimp 31/40"></td>
                        </tr>
                        <tr>
                            <td class="description">FRZ Marinated Asian Seabass</td>
                            <td class="num-box">EA</td>
                            <td class="retail strike-red">$10.35</td>
                            <td class="price">$7.39</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 874718009859_qty" placeholder="0" aria-label="Quantity for FRZ Marinated Asian Seabass"></td>
                        </tr>
                        <tr>
                            <td class="description">Searay China Yellow Croaker</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$6.99</td>
                            <td class="price">$4.99</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 827510000197_qty" placeholder="0" aria-label="Quantity for Searay China Yellow Croaker"></td>
                        </tr>
                        <tr>
                            <td class="description">Vs Basa Filt 12/14 3PC</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$4.42</td>
                            <td class="price">$3.15</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 871392003173_qty" placeholder="0" aria-label="Quantity for Vs Basa Filt 12/14 3PC"></td>
                        </tr>
                        <tr>
                            <td class="description">Greenland Turbot Halibut Steak</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$12.29</td>
                            <td class="price">$8.78</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 827510000340_qty" placeholder="0" aria-label="Quantity for Greenland Turbot Halibut Steak"></td>
                        </tr>
                        <tr>
                            <td class="description">Gold Label Golden Pompano</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$5.59</td>
                            <td class="price">$3.99</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 827510050055_qty" placeholder="0" aria-label="Quantity for Gold Label Golden Pompano"></td>
                        </tr>
                        <tr>
                            <td class="description">3Fish FRZ Snakehead Fish Slice</td>
                            <td class="num-box">250g </td>
                            <td class="retail strike-red">$6.99</td>
                            <td class="price">$4.99</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 874718005875_qty" placeholder="0" aria-label="Quantity for 3Fish FRZ Snakehead Fish Slice"></td>
                        </tr>
                        <tr>
                            <td class="description">Searay Greenland Turbot</td>
                            <td class="num-box">LB</td>
                            <td class="retail strike-red">$11.19</td>
                            <td class="price">$7.99</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 82751000018_qty" placeholder="0" aria-label="Quantity for Searay Greenland Turbot"></td>
                        </tr>
                        <tr>
                            <td class="description">Searay Fish Shaomai</td>
                            <td class="num-box">500G</td>
                            <td class="retail strike-red">$6.99</td>
                            <td class="price">$4.99</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 827510006144_qty" placeholder="0" aria-label="Quantity for Searay Fish Shaomai"></td>
                        </tr>
                        <tr>
                            <td class="description">3Fish FRZ Grass Carp Slice</td>
                            <td class="num-box">250g </td>
                            <td class="retail strike-red">$11.19</td>
                            <td class="price">$7.99</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 874718005868_qty" placeholder="0" aria-label="Quantity for 3Fish FRZ Grass Carp Slice"></td>
                        </tr>
                        <tr>
                            <td class="description">Searay Abalone with Shell</td>
                            <td class="num-box">220G</td>
                            <td class="retail strike-red">$9.79</td>
                            <td class="price">$6.99</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 827510004676_qty" placeholder="0" aria-label="Quantity for Searay Abalone with Shell"></td>
                        </tr>
                        </tbody><tfoot><tr><td colspan="5" style="border-bottom: none; padding: 3px;"></td></tr></tfoot></table></div></div>
                    <div id="grocery" class="tab-pane">
                        <div class="table-wrapper"><table><thead><tr>
                            <th class="description">Description</th>
                            <th class="num-box"># Box</th><th class="name">Retail</th><th class="price">Price</th><th class="qty">Qty</th>
                        </tr></thead><tbody>
                        <tr>
                            <td class="description">CC Salted Duck Eggs</td>
                            <td class="num-box">6PCS</td>
                            <td class="retail strike-red">$5.69</td>
                            <td class="price">$4.06</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 20616992827_qty" placeholder="0" aria-label="Quantity for CC Salted Duck Eggs"></td>
                        </tr>
                        <tr>
                            <td class="description">CC Peanut With Skin</td>
                            <td class="num-box">5LB </td>
                            <td class="retail strike-red">$18.20</td>
                            <td class="price">$13.00</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 613269006524_qty" placeholder="0" aria-label="Quantity for CC Peanut With Skin"></td>
                        </tr>
                        <tr>
                            <td class="description">Jin Xin Premium Rice Stick</td>
                            <td class="num-box"></td>
                            <td class="retail strike-red">$8.39</td>
                            <td class="price">$5.99</td>
                            <td class="qty-cell"><input type="number" min="0" class="qty-input" name="SKU: 1785_qty" placeholder="0" aria-label="Quantity for Jin Xin Premium Rice Stick"></td>
                        </tr>
                        </tbody><tfoot><tr><td colspan="5" style="border-bottom: none; padding: 3px;"></td></tr></tfoot></table></div></div>
                </div>
            <div class="table-wrapper" id="total-qty-footer-wrapper" style="border-top: 2px solid var(--header-bg-color); margin-top: 10px; border-bottom: none; border-left:none; border-right:none; border-radius:0;">
                <table>
                    <tfoot>
                        <tr>
                            <td class="name" style="border-bottom: none; visibility: hidden;"></td>
                            <td class="description" style="border-bottom: none; visibility: hidden;"></td>
                            <td class="num-box" style="border-bottom: none; visibility: hidden;"></td>
                            <td class="price" style="border-bottom: none; font-weight: 700; text-align: right;">TOTAL QTY:</td>
                            <td class="qty-cell" style="border-bottom: none; font-weight: 700; color: var(--accent-color); font-size: 1.2em;" id="table-total-qty">0</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <div id="visibleOrderSummaryContainer">
        <h2>Order Summary</h2>
        <div id="lineItemsDisplay">
            <div class="table-wrapper">
            <table id="orderSummaryTable">
            <thead>
                <tr>
                <th>Item</th>
                <th>Qty</th>
                <th>Amount</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                <td colspan="3" style="text-align:center; color: var(--text-color-secondary);">
                    No items selected yet.
                </td>
                </tr>
            </tbody>
            </table>
            </div>
            <table style="width: 100%; border-collapse: collapse;">
            <tfoot>
                <tr>
                <td colspan="2" style="text-align:right; padding: 8px; border-top: 2px solid var(--border-color); font-weight: 700;">Subtotal:</td>
                <td id="summarySubtotal" style="text-align:right; padding: 8px; border-top: 2px solid var(--border-color); font-weight: 700;">$0.00</td>
                </tr>
            </tfoot>
            </table>
        </div>
        </div>
        

            <input type="hidden" name="order_summary" id="order_summary">
            <input type="hidden" name="total_quantity" id="total_quantity_hidden">
            <input type="hidden" name="pickup_time_slot" id="pickup_time_slot_hidden">
            
            <div class="customer-info-section">
                <h2>Your Information</h2>
                <div class="form-group">
                    <label for="customerName">Name <span style="color: red;">*</span></label>
                    <input type="text" id="customerName" name="customer_name" placeholder="Full Name" required>
                </div>
                <div class="form-group">
                    <label for="customerEmail">Email (Optional)</label>
                    <input type="email" id="customerEmail" name="customer_email" placeholder="example@domain.com">
                </div>
                <div class="form-group">
                    <label for="customerPhone">Phone <span style="color: red;">*</span></label>
                    <input type="tel" id="customerPhone" name="customer_phone" placeholder="e.g., 604-555-1234" required>
                </div>
                <div class="form-group">
                    <label for="pickupDate">Requested Pickup Date <span style="color: red;">*</span></label>
                    <input type="date" id="pickupDate" name="pickup_date" required>
                </div>
                <div class="form-group">
                    <label>Preferred Pickup Time <span style="color: red;">*</span></label>
                    <div class="time-slot-container">
                        <label class="time-slot-btn">
                            <input type="radio" name="pickup_time_radio" value="9am-12pm" required>
                            9:00 AM - 12:00 PM
                        </label>
                        <label class="time-slot-btn">
                            <input type="radio" name="pickup_time_radio" value="12pm-4pm" required>
                            12:00 PM - 4:00 PM
                        </label>
                    </div>
                </div>
            </div>

            <div class="form-summary">
                <button type="submit" class="submit-button">Place Order</button>
            </div>

            <div class="success-message" id="success-message">
                Thank you! Your order has been submitted successfully. We will contact you soon.
            </div>

            <div class="error-message" id="error-message">
                Sorry, there was an error submitting your order. Please try again or call us directly.
            </div>
        </form>

        <div class="footer-contact">
            Call: <strong>Tops Supermarket - 403-276-8889</strong>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function() {
            const productsData = [
                {
                    retail: "28.76 (King\'s Chicken -7003)",
                    price: "$20.54",
                    box: "EA",
                    originalName: "28.76",
                    description: "King\'s Chicken -7003",
                    category: "Meat"
                }
,
                {
                    retail: "1.40 (Chicken)",
                    price: "$1.00",
                    box: "EA",
                    originalName: "1.40",
                    description: "Chicken",
                    category: "Meat"
                }
,
                {
                    retail: "3.01 (Yu Choy £¨Red£© - 421)",
                    price: "$2.15",
                    box: "LB",
                    originalName: "3.01",
                    description: "Yu Choy £¨Red£© - 421",
                    category: "Vegetable"
                }
,
                {
                    retail: "20.25 (Golden Logan box - 0801)",
                    price: "$14.46",
                    box: "CS",
                    originalName: "20.25",
                    description: "Golden Logan box - 0801",
                    category: "Fruit"
                }
,
                {
                    retail: "1.28 (Lo Bok - 450)",
                    price: "$0.91",
                    box: "LB",
                    originalName: "1.28",
                    description: "Lo Bok - 450",
                    category: "Vegetable"
                }
,
                {
                    retail: "2.01 (Short Nappa - 046)",
                    price: "$1.44",
                    box: "LB",
                    originalName: "2.01",
                    description: "Short Nappa - 046",
                    category: "Vegetable"
                }
,
                {
                    retail: "7.78 (Peruvian Mango)",
                    price: "$5.56",
                    box: "LB",
                    originalName: "7.78",
                    description: "Peruvian Mango",
                    category: "Fruit"
                }
,
                {
                    retail: "4.53 (Pork Front Feet)",
                    price: "$3.24",
                    box: "LB",
                    originalName: "4.53",
                    description: "Pork Front Feet",
                    category: "Meat"
                }
,
                {
                    retail: "4.49 (Green Chives -105)",
                    price: "$3.21",
                    box: "LB",
                    originalName: "4.49",
                    description: "Green Chives -105",
                    category: "Vegetable"
                }
,
                {
                    retail: "2.36 (Blue Jay Oranges - 4013)",
                    price: "$1.69",
                    box: "LB",
                    originalName: "2.36",
                    description: "Blue Jay Oranges - 4013",
                    category: "Fruit"
                }
,
                {
                    retail: "9.79 (Searay White Shrimp 31/40)",
                    price: "$6.99",
                    box: "1LB",
                    originalName: "9.79",
                    description: "Searay White Shrimp 31/40",
                    category: "Seafood"
                }
,
                {
                    retail: "4.42 (Yu Choy Mui - 460)",
                    price: "$3.16",
                    box: "LB",
                    originalName: "4.42",
                    description: "Yu Choy Mui - 460",
                    category: "Vegetable"
                }
,
                {
                    retail: "7.18 (Pork Belly Boneless)",
                    price: "$5.13",
                    box: "LB",
                    originalName: "7.18",
                    description: "Pork Belly Boneless",
                    category: "Meat"
                }
,
                {
                    retail: "8.77 (Utility Silkie Chicken)",
                    price: "$6.26",
                    box: "LB",
                    originalName: "8.77",
                    description: "Utility Silkie Chicken",
                    category: "Meat"
                }
,
                {
                    retail: "2.92 (Sweet Tangerine - 075)",
                    price: "$2.09",
                    box: "LB",
                    originalName: "2.92",
                    description: "Sweet Tangerine - 075",
                    category: "Fruit"
                }
,
                {
                    retail: "2.45 (Shang Hai Bok Choy - 033)",
                    price: "$1.75",
                    box: "LB",
                    originalName: "2.45",
                    description: "Shang Hai Bok Choy - 033",
                    category: "Vegetable"
                }
,
                {
                    retail: "10.35 (FRZ Marinated Asian Seabass)",
                    price: "$7.39",
                    box: "EA",
                    originalName: "10.35",
                    description: "FRZ Marinated Asian Seabass",
                    category: "Seafood"
                }
,
                {
                    retail: "6.99 (Searay China Yellow Croaker)",
                    price: "$4.99",
                    box: "LB",
                    originalName: "6.99",
                    description: "Searay China Yellow Croaker",
                    category: "Seafood"
                }
,
                {
                    retail: "4.42 (Vs Basa Filt 12/14 3PC)",
                    price: "$3.15",
                    box: "LB",
                    originalName: "4.42",
                    description: "Vs Basa Filt 12/14 3PC",
                    category: "Seafood"
                }
,
                {
                    retail: "12.29 (Greenland Turbot Halibut Steak)",
                    price: "$8.78",
                    box: "LB",
                    originalName: "12.29",
                    description: "Greenland Turbot Halibut Steak",
                    category: "Seafood"
                }
,
                {
                    retail: "5.69 (CC Salted Duck Eggs)",
                    price: "$4.06",
                    box: "6PCS",
                    originalName: "5.69",
                    description: "CC Salted Duck Eggs",
                    category: "Grocery"
                }
,
                {
                    retail: "18.20 (CC Peanut With Skin)",
                    price: "$13.00",
                    box: "5LB ",
                    originalName: "18.20",
                    description: "CC Peanut With Skin",
                    category: "Grocery"
                }
,
                {
                    retail: "11.85 (AAA Beef Fingermeat)",
                    price: "$8.47",
                    box: "LB",
                    originalName: "11.85",
                    description: "AAA Beef Fingermeat",
                    category: "Meat"
                }
,
                {
                    retail: "12.02 (AAA Beef Short Rib)",
                    price: "$8.59",
                    box: "LB",
                    originalName: "12.02",
                    description: "AAA Beef Short Rib",
                    category: "Meat"
                }
,
                {
                    retail: "2.97 (Chinese Eggplant  - 102)",
                    price: "$2.12",
                    box: "LB",
                    originalName: "2.97",
                    description: "Chinese Eggplant  - 102",
                    category: "Vegetable"
                }
,
                {
                    retail: "7.52 (WW Chinese Style Pork Sausage)",
                    price: "$5.37",
                    box: "375g",
                    originalName: "7.52",
                    description: "WW Chinese Style Pork Sausage",
                    category: "Meat"
                }
,
                {
                    retail: "12.05 (Beef Heel Muscle(Digital))",
                    price: "$8.61",
                    box: "LB",
                    originalName: "12.05",
                    description: "Beef Heel Muscle(Digital)",
                    category: "Meat"
                }
,
                {
                    retail: "5.59 (Gold Label Golden Pompano)",
                    price: "$3.99",
                    box: "LB",
                    originalName: "5.59",
                    description: "Gold Label Golden Pompano",
                    category: "Seafood"
                }
,
                {
                    retail: "6.99 (3Fish FRZ Snakehead Fish Slice)",
                    price: "$4.99",
                    box: "250g ",
                    originalName: "6.99",
                    description: "3Fish FRZ Snakehead Fish Slice",
                    category: "Seafood"
                }
,
                {
                    retail: "4.66 (Chicken Feet-Jumbo)",
                    price: "$3.33",
                    box: "LB",
                    originalName: "4.66",
                    description: "Chicken Feet-Jumbo",
                    category: "Meat"
                }
,
                {
                    retail: "3.78 (Shanghai Choy Mui - 0991)",
                    price: "$2.70",
                    box: "LB",
                    originalName: "3.78",
                    description: "Shanghai Choy Mui - 0991",
                    category: "Vegetable"
                }
,
                {
                    retail: "2.56 (Baby Bok Choy - 007)",
                    price: "$1.83",
                    box: "LB",
                    originalName: "2.56",
                    description: "Baby Bok Choy - 007",
                    category: "Vegetable"
                }
,
                {
                    retail: "11.19 (Searay Greenland Turbot)",
                    price: "$7.99",
                    box: "LB",
                    originalName: "11.19",
                    description: "Searay Greenland Turbot",
                    category: "Seafood"
                }
,
                {
                    retail: "3.65 (Gailan (Red) 0981)",
                    price: "$2.61",
                    box: "LB",
                    originalName: "3.65",
                    description: "Gailan (Red) 0981",
                    category: "Vegetable"
                }
,
                {
                    retail: "6.99 (Searay Fish Shaomai)",
                    price: "$4.99",
                    box: "500G",
                    originalName: "6.99",
                    description: "Searay Fish Shaomai",
                    category: "Seafood"
                }
,
                {
                    retail: "2.41 (Broccoli - 0361)",
                    price: "$1.72",
                    box: "LB",
                    originalName: "2.41",
                    description: "Broccoli - 0361",
                    category: "Vegetable"
                }
,
                {
                    retail: "1.40 (Pork)",
                    price: "$1.00",
                    box: "EA",
                    originalName: "1.40",
                    description: "Pork",
                    category: "Meat"
                }
,
                {
                    retail: "11.19 (3Fish FRZ Grass Carp Slice)",
                    price: "$7.99",
                    box: "250g ",
                    originalName: "11.19",
                    description: "3Fish FRZ Grass Carp Slice",
                    category: "Seafood"
                }
,
                {
                    retail: "1.58 (Cabbage - 0381)",
                    price: "$1.13",
                    box: "LB",
                    originalName: "1.58",
                    description: "Cabbage - 0381",
                    category: "Vegetable"
                }
,
                {
                    retail: "9.79 (Searay Abalone with Shell)",
                    price: "$6.99",
                    box: "220G",
                    originalName: "9.79",
                    description: "Searay Abalone with Shell",
                    category: "Seafood"
                }
,
                {
                    retail: "12.59 (Watson Cooked Young Duck)",
                    price: "$8.99",
                    box: "500g",
                    originalName: "12.59",
                    description: "Watson Cooked Young Duck",
                    category: "Meat"
                }
,
                {
                    retail: "3.56 (A Choy -119)",
                    price: "$2.55",
                    box: "LB",
                    originalName: "3.56",
                    description: "A Choy -119",
                    category: "Vegetable"
                }
,
                {
                    retail: "6.20 (Pork Shoulder Butt)",
                    price: "$4.43",
                    box: "LB",
                    originalName: "6.20",
                    description: "Pork Shoulder Butt",
                    category: "Meat"
                }
,
                {
                    retail: "3.55 (Ginger - 004)",
                    price: "$2.54",
                    box: "LB",
                    originalName: "3.55",
                    description: "Ginger - 004",
                    category: "Vegetable"
                }
,
                {
                    retail: "8.39 (Jin Xin Premium Rice Stick)",
                    price: "$5.99",
                    box: "",
                    originalName: "8.39",
                    description: "Jin Xin Premium Rice Stick",
                    category: "Grocery"
                }
            ];

    const orderForm = document.getElementById('orderForm');
    const submitButton = document.querySelector('.submit-button');
    const successMessage = document.getElementById('success-message');
    const errorMessage = document.getElementById('error-message');
    const orderSummaryInput = document.getElementById('order_summary');
    const totalQuantityHiddenInput = document.getElementById('total_quantity_hidden');
    const pickupDateInput = document.getElementById('pickupDate');
    const tableTotalQtyElement = document.getElementById('table-total-qty');
    const pickupTimeHidden = document.getElementById('pickup_time_slot_hidden');

    // Add icons to tab buttons based on their text content
    function addTabIcons() {
        const tabButtons = document.querySelectorAll('.tab-button');
        tabButtons.forEach(button => {
            const buttonText = button.textContent.toLowerCase().trim();
            let icon = '';
            
            // Match category names and add appropriate icons
            if (buttonText.includes('vegetable') || buttonText.includes('veggies')) {
                icon = 'ð¥ ';
            } else if (buttonText.includes('meat')) {
                icon = 'ð¥© ';
            } else if (buttonText.includes('fruit')) {
                icon = 'ð ';
            } else if (buttonText.includes('grocery')) {
                icon = 'ð ';
            } else if (buttonText.includes('seafood')) {
                icon = 'ð¦ ';
            } else {
                // Default icon for any other categories
                icon = 'ð¦ ';
            }
            
            // Prepend icon to button text
            button.innerHTML = icon + button.textContent;
        });
    }

    // Call the function to add icons
    addTabIcons();

    // Set minimum date
    if (pickupDateInput) {
        const today = new Date().toISOString().split('T')[0];
        pickupDateInput.setAttribute('min', today);
    }

    // Handle time slot selection
    const timeSlotBtns = document.querySelectorAll('.time-slot-btn');
    timeSlotBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            timeSlotBtns.forEach(b => b.classList.remove('selected'));
            this.classList.add('selected');
            const radio = this.querySelector('input[type="radio"]');
            radio.checked = true;
            pickupTimeHidden.value = radio.value;
        });
    });

    function updateTotalQuantity() {
        let currentTotal = 0;
        
        // Calculate total from all quantity inputs
        document.querySelectorAll('.qty-input').forEach(input => {
            currentTotal += parseInt(input.value, 10) || 0;
        });
        
        // Update visible total
        if(tableTotalQtyElement) {
            tableTotalQtyElement.textContent = currentTotal;
        }
        
        // Update hidden total
        if(totalQuantityHiddenInput) {
            totalQuantityHiddenInput.value = currentTotal;
        }
        
        // Update order summary
        generateOrderSummary();
    }

        function generateOrderSummary() {
            const tbody = document.querySelector('#orderSummaryTable tbody');
            tbody.innerHTML = '';
            let subtotal = 0;
            const orderLines = [];

            // Get all quantity inputs
            const allInputs = document.querySelectorAll('.qty-input');
            console.log('=== ORDER SUMMARY GENERATION ===');
            console.log('Total inputs:', allInputs.length);

            allInputs.forEach((input, index) => {
                const qty = parseInt(input.value, 10) || 0;
                
                if (qty > 0) {
                    console.log(`Processing input ${index}: name="${input.name}", qty=${qty}`);
                    
                    // Get the product info from the same row
                    const row = input.closest('tr');
                    let productName = '';
                    let productPrice = '';
                    
                    if (row) {
                        // Get the description from the same row
                        const descCell = row.querySelector('td.description');
                        if (descCell) {
                            productName = descCell.textContent.trim();
                            console.log('Found product name from row:', productName);
                        }
                        
                        // Get the price from the same row
                        const priceCell = row.querySelector('td.price');
                        if (priceCell) {
                            productPrice = priceCell.textContent.trim();
                            console.log('Found price from row:', productPrice);
                        }
                    }
                    
                    // Parse price
                    const priceNum = parseFloat(productPrice.replace(/[^0-9.\-]+/g, ''));
                    if (!isNaN(priceNum)) {
                        const amount = qty * priceNum;
                        subtotal += amount;

                        // Create table row
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${productName}</td>
                            <td>${qty}</td>
                            <td>$${amount.toFixed(2)}</td>
                        `;
                        tbody.appendChild(tr);
                        
                        // Add to order lines
                        orderLines.push(`${productName}: ${qty} @ $${priceNum.toFixed(2)} = $${amount.toFixed(2)}`);
                        console.log('Added to order summary:', productName);
                    } else {
                        console.log('Could not parse price:', productPrice);
                    }
                }
            });

            // Show empty message if no items
            if (tbody.children.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" style="text-align:center; color: var(--text-color-secondary);">No items selected yet.</td></tr>';
            }

            console.log('Total items in order:', orderLines.length);
            console.log('Subtotal:', subtotal);

            // Update subtotal
            document.getElementById('summarySubtotal').textContent = '$' + subtotal.toFixed(2);

            // Update hidden order summary
            const orderSummaryInput = document.getElementById('order_summary');
            if (orderSummaryInput) {
                if (orderLines.length > 0) {
                    orderSummaryInput.value = orderLines.join('\n') + '\n\nTotal: $' + subtotal.toFixed(2);
                } else {
                    orderSummaryInput.value = '';
                }
            }
        }

    // Wait for VBA to generate inputs, then add quantity controls
    setTimeout(function() {

        // Add plus/minus buttons to quantity inputs
        document.querySelectorAll('.qty-input').forEach((input, index) => {
            // Store the original name attribute
            const originalName = input.name;
            
            const wrapper = document.createElement('div');
            wrapper.className = 'qty-controls';
            
            const minusBtn = document.createElement('button');
            minusBtn.type = 'button';
            minusBtn.className = 'qty-btn minus';
            minusBtn.textContent = 'â';
            minusBtn.onclick = function() {
                const currentVal = parseInt(input.value) || 0;
                if (currentVal > 0) {
                    input.value = currentVal - 1;
                    updateTotalQuantity();
                }
            };
            
            const plusBtn = document.createElement('button');
            plusBtn.type = 'button';
            plusBtn.className = 'qty-btn plus';
            plusBtn.textContent = '+';
            plusBtn.onclick = function() {
                const currentVal = parseInt(input.value) || 0;
                input.value = currentVal + 1;
                updateTotalQuantity();
            };
            
            // Replace input with wrapper
            input.parentNode.insertBefore(wrapper, input);
            wrapper.appendChild(minusBtn);
            wrapper.appendChild(input);
            wrapper.appendChild(plusBtn);
            
            // Ensure the name attribute is preserved
            input.name = originalName;
        });

        // Event delegation for quantity inputs
        document.addEventListener('input', function(e) {
            if (e.target.classList.contains('qty-input')) {
                updateTotalQuantity();
            }
        });

        // Initialize
        updateTotalQuantity();
    }, 100);

    // Add after the VBA generates the content
    setTimeout(function() {
        // Handle description cell expansion - make ALL description cells expandable
        document.querySelectorAll('td.description').forEach((td) => {
            // Store the original text content
            const originalText = td.textContent.trim();
            
            td.addEventListener('click', function(e) {
                e.stopPropagation();
                
                // Close any other expanded descriptions
                document.querySelectorAll('tr.description-expanded').forEach(tr => {
                    tr.classList.remove('description-expanded');
                    // Restore original text for all other cells
                    const otherTd = tr.querySelector('td.description');
                    if (otherTd && otherTd.dataset.originalText) {
                        otherTd.textContent = otherTd.dataset.originalText;
                    }
                });
                
                // Toggle this description
                const row = this.closest('tr');
                if (!row.classList.contains('description-expanded')) {
                    row.classList.add('description-expanded');
                    
                    // Store original text if not already stored
                    if (!this.dataset.originalText) {
                        this.dataset.originalText = originalText;
                    }
                    
                    // Try to find the matching product by using the quantity input name in this row
                    let fullText = originalText;
                    if (typeof productsData !== 'undefined') {
                        // Find the quantity input in this row
                        const qtyInput = row.querySelector('.qty-input');
                        if (qtyInput && qtyInput.name) {
                            // Extract SKU from the input name (e.g., "SKU: 801_qty" -> "801")
                            const skuMatch = qtyInput.name.match(/SKU:\s*(.+?)_qty/);
                            if (skuMatch) {
                                const sku = skuMatch[1].trim();
                                
                                // Find the product with matching SKU in the data
                                const matchingProduct = productsData.find(product => {
                                    if (!product.description) return false;
                                    
                                    // First try exact match with originalName field
                                    if (product.originalName && product.originalName === sku) {
                                        return true;
                                    }
                                    
                                    // For products with SKU codes in description, be more specific
                                    // Check if the description ends with " - SKU" pattern
                                    const descriptionEndsWithSku = product.description.match(/\s-\s(\d+)$/);
                                    if (descriptionEndsWithSku && descriptionEndsWithSku[1] === sku) {
                                        return true;
                                    }
                                    
                                    // Fallback: check if description contains the SKU but be more careful
                                    // Only match if it's the exact SKU and not part of a longer number
                                    const skuPattern = new RegExp(`\\b${sku}\\b`);
                                    return skuPattern.test(product.description);
                                });
                                
                                if (matchingProduct && matchingProduct.description) {
                                    fullText = matchingProduct.description;
                                }
                            }
                        }
                    }
                    
                    // Show full text during expansion (fallback to original if no match found)
                    this.textContent = fullText;
                    
                    // Close when clicking outside
                    setTimeout(() => {
                        const closeHandler = (event) => {
                            if (!row.contains(event.target)) {
                                row.classList.remove('description-expanded');
                                // Restore original text
                                this.textContent = this.dataset.originalText;
                                document.removeEventListener('click', closeHandler);
                            }
                        };
                        document.addEventListener('click', closeHandler);
                    }, 100);
                }
            });
        });
    }, 200);

    // Tab switching
    const tabButtons = document.querySelectorAll('.tab-navigation .tab-button');
    const tabPanes = document.querySelectorAll('.tab-content .tab-pane');

    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            tabButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            const targetTab = button.dataset.tab;
            tabPanes.forEach(pane => {
                if (pane.id === targetTab) {
                    pane.classList.add('active');
                } else {
                    pane.classList.remove('active');
                }
            });
        });
    });

    // Form submission
    if (orderForm) {
        orderForm.addEventListener('submit', function(event) {
            event.preventDefault();
            
            const customerName = document.getElementById('customerName').value.trim();
            const customerPhone = document.getElementById('customerPhone').value.trim();
            const pickupDateVal = document.getElementById('pickupDate').value;
            const pickupTimeVal = pickupTimeHidden.value;
            const totalQty = parseInt(totalQuantityHiddenInput.value, 10) || 0;

            // Hide messages
            if(successMessage) successMessage.style.display = 'none';
            if(errorMessage) errorMessage.style.display = 'none';

            // Validate required fields
            if (!customerName || !customerPhone || !pickupDateVal || !pickupTimeVal) {
                alert('Please fill in all required fields (Name, Phone, Pickup Date, and Pickup Time).');
                return;
            }

            // Check if items selected
            if (totalQty === 0) {
                alert('Please select at least one item to order.');
                return;
            }

            // Disable submit button
            if(submitButton) {
                submitButton.disabled = true;
                submitButton.textContent = 'Submitting...';
            }

            // Submit form
            const formData = new FormData(orderForm);
            
            fetch(orderForm.action, { 
                method: 'POST',
                body: formData,
                headers: { 'Accept': 'application/json' }
            }).then(response => {
                if (response.ok) {
                    if(successMessage) successMessage.style.display = 'block';
                    orderForm.reset();
                    timeSlotBtns.forEach(b => b.classList.remove('selected'));
                    updateTotalQuantity();
                    if (pickupDateInput) {
                        const today = new Date().toISOString().split('T')[0];
                        pickupDateInput.setAttribute('min', today);
                    }
                    if(successMessage) successMessage.scrollIntoView({ behavior: 'smooth' });
                } else {
                    throw new Error('Form submission failed');
                }
            }).catch(error => {
                console.error('Error:', error);
                if(errorMessage) {
                    errorMessage.textContent = 'Sorry, there was an error submitting your order. Please try again or call us directly.';
                    errorMessage.style.display = 'block';
                    errorMessage.scrollIntoView({ behavior: 'smooth' });
                }
            }).finally(() => {
                if(submitButton) {
                    submitButton.disabled = false;
                    submitButton.textContent = 'Place Order';
                }
            });
        });
    }
});
</script>
</body>
</html>
